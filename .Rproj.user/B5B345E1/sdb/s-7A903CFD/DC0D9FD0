{
    "collab_server" : "",
    "contents" : "################################################################################\n## Name: scrape_lyrics.R\n## Description: Functions to scrape lyrics from letras.musica.\n## Author: ebvm\n## Date: 2017-10-01\n################################################################################\n\n## Libraries\nlibrary(tidyverse)\nlibrary(rvest)\n\n## Site\nsite <- 'https://www.letras.com'\nartist_page <- 'https://www.letras.com/chico-buarque/'\n\n\nsong_index <- artist_page %>%\n  read_html() %>%\n  html_nodes(\"#cnt-artist-songlist > div.cnt-list--alp > ul\") %>%\n  html_children()\n\nget_lyrics <- function(link){\n  scrape <- link %>% \n    read_html()\n  lyrics <- scrape %>%\n    html_nodes(\"#js-lyric-cnt > div.g-pr.g-sp > div.cnt-letra > article\") %>%\n    html_children() %>%\n    gsub(pattern = '<br>', replacement = \"\\n\") %>%\n    gsub(pattern = '<.*?>', replacement = '')\n  lyrics1 <- strsplit(lyrics,'\\n')\n  return(lyrics1)\n}\n\nsong_info <- function(a){\n  d <- a %>% html_children()\n  song <- list(name=html_text(d))\n  song[['link']] <- paste0(site,html_attr(d,\"href\"))\n  song[['lyrics']] <- tryCatch(get_lyrics(song$link), error = function(e) e)\n  return(song)\n}\n\nall_songs <- map(song_index,song_info)\nnames(all_songs) <- lapply(all_songs, function(x) x$name)\n\nsaveRDS(all_songs, file = 'chico_buarque_song_list.rds')\n",
    "created" : 1506874530229.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2902762367",
    "id" : "DC0D9FD0",
    "lastKnownWriteTime" : 1506899933,
    "last_content_update" : 1506899933,
    "path" : "~/Documents/letras/scrape_lyrics.R",
    "project_path" : "scrape_lyrics.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}