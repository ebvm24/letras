{
    "collab_server" : "",
    "contents" : "################################################################################\n## Name: tidy_lyrics.R\n## Description: Turn lyrics into tidy data.\n## Author: ebvm\n## Date: 2017-10-01\n################################################################################\n\n## Libraries\nlibrary(tidyverse)\nlibrary(tidytext)\nlibrary(reshape2)\n\n## My Theme\n\nmy_theme <- theme_minimal()\ntheme_set(my_theme)\n\n#source('scrape_lyrics.R')\n## Tidy Data\n\nall_songs <- readRDS(file = 'chico_buarque_song_list.rds')\n\nstop_words_pt <- read_table('stopwords.txt',col_names='word')\n\na <- all_songs$`A Banda`\n\nlyrics <- melt(a$lyrics)\nnames(lyrics) <- c('Lyric','Stanza')\n\nlyrics$Lyric <- as.character(lyrics$Lyric)\nlyrics$Line <- seq(1,length(lyrics$Lyric))\n\nlyrics <- as_data_frame(lyrics)\n\n# Unnest Tokens\ntidy_song <- lyrics %>%\n  unnest_tokens(word,Lyric) %>%\n  anti_join(stop_words_pt)\n\ntidy_song %>%\n  count(word, sort=TRUE) %>%\n  mutate(word = reorder(word,n)) %>%\n  filter(n>1) %>%\n  ggplot(aes(x=word, y=n,fill=n)) +\n  geom_col()+\n  scale_fill_gradient2(low = \"yellow\", mid = \"forestgreen\",high = \"blue\", midpoint = 5) +\n  xlab(NULL)+\n  coord_flip()\n\n## All of Chico Buarque's Songs in Portuguese\nall <- all_songs\n\nspan <- c('Mar Y Luna')\nfren <- c('La Nuit Des Masques')\nital <- c('La TV', 'La Rita', 'La Banda', 'Vita',\n          'Una Mia Canzone','Tu Sei Una Di Noi',\n          'Rotativa',\n          'Queste e Quelle',\n          'Oh Che Sarà',\n          'Non Vuoi Ascoltare',\n          \"Maddalena E' Andata Via\",\n          \"Lei No, Lei Sta Ballando (Ela Desatinou)\",\n          \"In Te (Mulher, Vou Dizer Quanto Eu Te Amo)\",\n          \"In Memoria Di Un Congiurate\",\n          \"Il Nome Di Maria (Não Fala de Maria)\",\n          \"Genova Per Noi\",\n          \"Funerale Di Un Contadino\",\n          \"Far Niente (Bom Tempo)\",\n          \"Ed Ora Dico Sul Serio (Agora Falando Sério)\",\n          \"C´è più samba\",\n          \"Ciao, Ciao, Addio\",\n          \"C'è Più Samba\")\n\nmap_lyrics <- function(x){\n  if(length(x[['lyrics']])==0){\n    return(NA)\n  }\n  df <- data.frame(melt(x[['lyrics']]))\n  df$Song <- x[['name']]\n  names(df) <- c('Lyric', 'Stanza', 'Song')\n  return(df)\n}\n\nlyrics <- map(all,map_lyrics)\nlyrics <- do.call(rbind.data.frame,lyrics)\nlyrics <- lyrics1 %>% \n  group_by(Song) %>%\n  mutate(Line = seq(1,length(Lyric)),\n         Lyric = as.character(Lyric)) %>%\n  ungroup()\nlyrics <- as_data_frame(lyrics) %>%\n  filter(!Song %in% fren,\n         !Song %in% ital,\n         !Song %in% span) # Let's just consider portuguese songs, please\n\n\n## Unnest Tokens in All Songs\n# Unnest Tokens\ntidy_songs <- lyrics %>%\n  unnest_tokens(word,Lyric) %>%\n  anti_join(stop_words_pt)\n\ntidy_songs %>%\n  count(word, sort=TRUE) %>%\n  mutate(word = reorder(word,n)) %>%\n  top_n(20,n) %>%\n  ggplot(aes(x=word, y=n,fill=n)) +\n  geom_col()+\n  scale_fill_gradient2(low = \"yellow\", mid = \"forestgreen\",high = \"dodgerblue3\", midpoint = 50) +\n  xlab(NULL)+\n  coord_flip()\n\npra <- lyrics %>%\n  filter(grepl('pra',Lyric)) %>% distinct(Song)\npra\nche <- lyrics %>%\n  filter(grepl(' che ',Lyric)) %>% distinct(Song)\nche %>% print(n=25)\n\n#' Ok, some of these words should be added to our stop words file:\n#' pra: contraction of para\n#' \n",
    "created" : 1506890910833.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2757797855",
    "id" : "FFA9CA87",
    "lastKnownWriteTime" : 1506904236,
    "last_content_update" : 1506904236679,
    "path" : "~/Documents/letras/a_banda.R",
    "project_path" : "a_banda.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}